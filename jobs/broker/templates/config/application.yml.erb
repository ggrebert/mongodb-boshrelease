---
logging:
  level: DEBUG

management:
  context-path: /admin

pidfile: /var/vcap/sys/run/broker/broker.pid

security:
  user:
    name: <%= p('broker.user') %>
    password: <%= p('broker.password') %>

spring:
  main:
    show-banner: true

mongodb:
<% if_link("server") do %>
  host: <% nodes = link('server') %><% nodes.instances.each do |instance| %><%= instance.address %>,<% end %>
  port: 27017
  username: <%= link('server').p('root_username') %>
  password: <%= link('server').p('root_password') %>

server:
  port: <%= p('broker.port').to_json %>
catalog_yml: <%= p('broker.catalog_yml').to_json %>
<% end %>
<% if_link("routing-server") do %>
  host: <% nodes = link('routing-server') %><% nodes.instances.each do |instance| %><%= instance.address %>,<% end %>
  port: 27017
  username: <%= link('routing-server').p('root_username') %>
  password: <%= link('routing-server').p('root_password') %>

server:
  port: <%= p('broker.port').to_json %>
catalog_yml: <%= p('broker.catalog_yml').to_json %>  
<% end %> 